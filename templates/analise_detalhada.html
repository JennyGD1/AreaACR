{% extends "base.html" %}

{% block title %}Análise de Contracheque - Maida{% endblock %}

{% block body_class %}page-analise{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pages/analise.css') }}">
{% endblock %}

{% block content %}
<div class="analysis-container">
    <h1>Análise do Contracheque</h1>
    {% if resultados.primeiro_mes %}
        <p class="periodo">Período analisado de {{ resultados.primeiro_mes }} a {{ resultados.ultimo_mes }}</p>
    {% endif %}

    <section class="proventos-section">
        <h2>Tabela de Proventos</h2>
        {% if resultados.proventos_totais_planserv and resultados.proventos_totais_planserv.detalhes %}
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Descrição</th>
                        <th>Código</th>
                        <th class="col-valor">Valor (R$)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in resultados.proventos_totais_planserv.detalhes %}
                    <tr>
                        <td>{{ item.descricao }}</td>
                        <td>{{ item.codigo }}</td>
                        <td class="col-valor">{{ "%.2f"|format(item.valor)|replace('.', ',') }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="2">TOTAL PROVENTOS</td>
                        <td class="col-valor">R$ {{ "%.2f"|format(resultados.proventos_totais_planserv.total)|replace('.', ',') }}</td>
                    </tr>
                </tfoot>
            </table>
        {% else %}
            <p>Nenhum provento encontrado para análise.</p>
        {% endif %}
    </section>

    <section class="descontos-section">
        <h2>Tabela de Descontos</h2>
        {% if resultados.descontos_totais_planserv and resultados.descontos_totais_planserv.detalhes %}
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Descrição</th>
                        <th>Código</th>
                        <th class="col-valor">Valor (R$)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in resultados.descontos_totais_planserv.detalhes %}
                    <tr>
                        <td>{{ item.descricao }}</td>
                        <td>{{ item.codigo }}</td>
                        <td class="col-valor">{{ "%.2f"|format(item.valor)|replace('.', ',') }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="2">TOTAL DESCONTOS</td>
                        <td class="col-valor">R$ {{ "%.2f"|format(resultados.descontos_totais_planserv.total)|replace('.', ',') }}</td>
                    </tr>
                </tfoot>
            </table>
        {% else %}
            <p>Nenhum desconto relevante encontrado.</p>
        {% endif %}
    </section>

    <a href="{{ url_for('calculadora') }}" class="action-button">Fazer Nova Análise</a>

</div>
{% endblock %}
